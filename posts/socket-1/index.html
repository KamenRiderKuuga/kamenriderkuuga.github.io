<!doctype html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="制作一个基于.NET原生Socket的WEB API转发工具(1) - TCP协议" /><meta name="author" content="HANABI" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="Socket编程是网络编程中的重中之重，.NET为我们提供了丰富，详细的类库为我们使用C#进行Socket编程提供帮助，这里作为学习，会尽可能使用相对基础的Socket类库，来完成整个程序的构建，首先我们来了解Socket，因为是直接学习Socket，对于更底层的协议不会推进得那么深入彻底，主要会介绍一些相对重要的概念，先了解TCP协议" /><meta property="og:description" content="Socket编程是网络编程中的重中之重，.NET为我们提供了丰富，详细的类库为我们使用C#进行Socket编程提供帮助，这里作为学习，会尽可能使用相对基础的Socket类库，来完成整个程序的构建，首先我们来了解Socket，因为是直接学习Socket，对于更底层的协议不会推进得那么深入彻底，主要会介绍一些相对重要的概念，先了解TCP协议" /><link rel="canonical" href="https://lambda.cyou//posts/socket-1/" /><meta property="og:url" content="https://lambda.cyou//posts/socket-1/" /><meta property="og:site_name" content="HANABI" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-29T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="制作一个基于.NET原生Socket的WEB API转发工具(1) - TCP协议" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@HANABI" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HANABI"},"dateModified":"2020-07-29T00:00:00+08:00","datePublished":"2020-07-29T00:00:00+08:00","description":"Socket编程是网络编程中的重中之重，.NET为我们提供了丰富，详细的类库为我们使用C#进行Socket编程提供帮助，这里作为学习，会尽可能使用相对基础的Socket类库，来完成整个程序的构建，首先我们来了解Socket，因为是直接学习Socket，对于更底层的协议不会推进得那么深入彻底，主要会介绍一些相对重要的概念，先了解TCP协议","headline":"制作一个基于.NET原生Socket的WEB API转发工具(1) - TCP协议","mainEntityOfPage":{"@type":"WebPage","@id":"https://lambda.cyou//posts/socket-1/"},"url":"https://lambda.cyou//posts/socket-1/"}</script><title>制作一个基于.NET原生Socket的WEB API转发工具(1) - TCP协议 | HANABI</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="HANABI"><meta name="application-name" content="HANABI"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/link.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><h1 class="site-title"> <a href="/">HANABI</a></h1><p class="site-subtitle fst-italic mb-0">可乐说自己是好猫</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>归档</span> </a><li class="nav-item"> <a href="/read/" class="nav-link"> <i class="fa-fw fas fa-book-reader"></i> <span>札记</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/KamenRiderKuuga" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github-alt"></i> </a> <a href="javascript:location.href = 'mailto:' + ['wpfmaker','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>制作一个基于.NET原生Socket的WEB API转发工具(1) - TCP协议</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> 文章</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">取消</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>制作一个基于.NET原生Socket的WEB API转发工具(1) - TCP协议</h1><div class="post-meta text-muted"> <span> 发表于 <time data-ts="1595952000" data-df="YYYY/MM/DD" data-bs-toggle="tooltip" data-bs-placement="bottom" > 2020/07/29 </time> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href=""></a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="7455 字" > <em>41 分钟</em>阅读</span></div></div></header><div class="content"><blockquote><p>Socket编程是网络编程中的重中之重，.NET为我们提供了丰富，详细的类库为我们使用C#进行Socket编程提供帮助，这里作为学习，会尽可能使用相对基础的Socket类库，来完成整个程序的构建，首先我们来了解Socket，因为是直接学习Socket，对于更底层的协议不会推进得那么深入彻底，主要会介绍一些相对重要的概念，先了解TCP协议</p></blockquote><h2 id="了解tcp协议"><span class="me-2">了解TCP协议</span><a href="#了解tcp协议" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="先看结论"><span class="me-2">先看结论</span><a href="#先看结论" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>TCP协议是面向<strong>连接</strong>的，<strong>可靠</strong>的传输层协议</p><h3 id="什么是连接"><span class="me-2">什么是连接</span><a href="#什么是连接" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>这里的连接不是指我们用网线进行的物理的连接，而是指一种逻辑上的连接，双方可以通过某种方式，访问到对方的资源，就称之为连接。那么为什么说这个连接是可靠的呢，为了了解，或者说印证这个结论，先让我们了解TCP的报文格式</p><h3 id="tcp报文"><span class="me-2">TCP报文</span><a href="#tcp报文" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>报文</strong>(message)，用百度百科上的话来说</p><blockquote><p>报文(message)是网络中交换与传输的数据单元，即站点一次性要发送的数据块。报文包含了将要发送的完整的数据信息，其长短很不一致，长度不限且可变。</p></blockquote><p>通俗的说，就是通信双方在通信中每次要发送的数据，这个整体，我们称之为报文，我们先来看一个TCP报文的格式</p><p><a href="/assets/img/socket-1.jpg" class="popup img-link shimmer"><img src="/assets/img/socket-1.jpg" alt="" loading="lazy"></a></p><p>从左上部分到右下部分依次开始了解：</p><p><strong>Source Port &amp; Destination Port</strong>：端口号 - 源计算机上应用程序的端口号和目标计算机上应用程序的端口号，都分别占16位</p><p><strong>Sequence Number</strong>：序列号 - 32位无符号整数，在TCP传输中，传输的字节流中的每个字节都会被编号，当<code class="language-plaintext highlighter-rouge">SYN</code>(后面会介绍什么是<code class="language-plaintext highlighter-rouge">SYN</code>)为1时，即建立连接时，这个字段的值是一个初始值，也被称为<strong>ISN(initialization sequence number)</strong>，当<code class="language-plaintext highlighter-rouge">SYN</code>不为1时，是传输数据段中第一个字节的序列号</p><p><strong>Acknowledgement Number</strong>：确认号 - 也是32位无符号整数，表示接受方期望收到发送方下一个报文数据段的第一个字节数据的编号，其值是接收计算机即将接收到的下一个序列号</p><p><strong>Data Offset</strong>：数据偏移量 - 占4位，指数据段中的需要的数据部分起始处距离TCP数据段的字节偏移量，告诉接收端的应用程序，数据从何处开始</p><p><strong>Reserved</strong>：保留字段，占4位，为TCP将来的发展预留空间，目前必须全部为0</p><p><strong>标志位字段</strong>(关于标志位字段的定义这里是完全从网络资料复制的，因为对前面三个标志位体会还不是很深)：</p><ul><li><code class="language-plaintext highlighter-rouge">CWR</code>（Congestion Window Reduce）：拥塞窗口减少标志，用来表明它接收到了设置 <code class="language-plaintext highlighter-rouge">ECE</code> 标志的 TCP 包。并且，发送方收到消息之后，通过减小发送窗口的大小来降低发送速率。<li><code class="language-plaintext highlighter-rouge">ECE</code>（ECN Echo）：用来在 TCP 三次握手时表明一个 TCP 端是具备 ECN 功能的。在数据传输过程中，它也用来表明接收到的 TCP 包的 IP 头部的 ECN 被设置为 11，即网络线路拥堵。<li><code class="language-plaintext highlighter-rouge">URG</code>（Urgent）：表示本报文段中发送的数据是否包含紧急数据。<code class="language-plaintext highlighter-rouge">URG</code>=1 时表示有紧急数据。当 <code class="language-plaintext highlighter-rouge">URG</code>=1 时，后面的紧急指针字段才有效。<li><code class="language-plaintext highlighter-rouge">ACK</code>：表示前面的确认号字段是否有效。<code class="language-plaintext highlighter-rouge">ACK</code>=1 时表示有效。只有当 <code class="language-plaintext highlighter-rouge">ACK</code>=1 时，前面的确认号字段才有效。TCP 规定，连接建立后，<code class="language-plaintext highlighter-rouge">ACK</code> 必须为 1。<li><code class="language-plaintext highlighter-rouge">PSH</code>（Push）：告诉对方收到该报文段后是否立即把数据推送给上层。如果值为 1，表示应当立即把数据提交给上层，而不是缓存起来。<li><code class="language-plaintext highlighter-rouge">RST</code>：表示是否重置连接。如果 <code class="language-plaintext highlighter-rouge">RST</code>=1，说明 TCP 连接出现了严重错误（如主机崩溃），必须释放连接，然后再重新建立连接。<li><code class="language-plaintext highlighter-rouge">SYN</code>：在建立连接时使用，用来同步序号。当 <code class="language-plaintext highlighter-rouge">SYN</code>=1，<code class="language-plaintext highlighter-rouge">ACK</code>=0 时，表示这是一个请求建立连接的报文段；当 <code class="language-plaintext highlighter-rouge">SYN</code>=1，<code class="language-plaintext highlighter-rouge">ACK</code>=1 时，表示对方同意建立连接。<code class="language-plaintext highlighter-rouge">SYN</code>=1 时，说明这是一个请求建立连接或同意建立连接的报文。只有在前两次握手中 <code class="language-plaintext highlighter-rouge">SYN</code> 才为 1。<li><code class="language-plaintext highlighter-rouge">FIN</code>：标记数据是否发送完毕。如果<code class="language-plaintext highlighter-rouge"> FIN</code>=1，表示数据已经发送完成，可以释放连接。</ul><p><strong>窗口大小字段</strong></p><p>窗口大小（Window Size）：占 16 位。它表示从 Ack Number 开始还可以接收多少字节的数据量，也表示当前接收端的接收窗口还有多少剩余空间。该字段可以用于 TCP 的流量控制。</p><p><strong>TCP 校验和字段</strong></p><p>校验位（TCP Checksum）：占 16 位。它用于确认传输的数据是否有损坏。发送端基于数据内容校验生成一个数值，接收端根据接收的数据校验生成一个值。两个值必须相同，才能证明数据是有效的。如果两个值不同，则丢掉这个数据包。Checksum 是根据伪头 + TCP 头 + TCP 数据三部分进行计算的。</p><p><strong>紧急指针字段</strong></p><p>紧急指针（Urgent Pointer）：仅当前面的 URG 控制位为 1 时才有意义。它指出本数据段中为紧急数据的字节数，占 16 位。当所有紧急数据处理完后，TCP 就会告诉应用程序恢复到正常操作。即使当前窗口大小为 0，也是可以发送紧急数据的，因为紧急数据无须缓存。</p><p><strong>可选项字段</strong></p><p>选项（Option）：长度不定，但长度必须是 32bits 的整数倍。</p><p>讲到这里，大家肯定还是对这些报文在TCP连接中有什么用，它们为什么使TCP连接变得可靠有疑惑，接下来我们会对这个过程进行详细分析，在分析之前，先让我们简单了解一个概念，HTTP协议</p><h3 id="http协议摘自知乎回答"><span class="me-2">HTTP协议(摘自<a href="https://www.zhihu.com/question/38648948/answer/520510413">知乎回答</a>)</span><a href="#http协议摘自知乎回答" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>HTTP协议即超文本传送协议(Hypertext Transfer Protocol )，是Web联网的基础，也是手机联网常用的协议之一，HTTP协议是建立在TCP协议之上的一种应用。</p><p>HTTP连接最显著的特点是客户端发送的每次请求都需要服务器回送响应，在请求结束后，会主动释放连接<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>。从建立连接到关闭连接的过程称为“一次连接”。</p><h3 id="抓包分析"><span class="me-2">抓包分析</span><a href="#抓包分析" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>根据前文的知识，我们已经知道，HTTP是一个基于TCP的应用层协议，在一次正常的HTTP请求的开始到结束，都会完成建立连接，数据传输，释放连接这一完整的过程，那么我们只需要分析一个完整的HTTP请求，再进行分析，就可以得出相应的结论了</p><p>抓包分析，顾名思义，就是对网络传输过程中的一些数据包进行抓取分析，为了用尽量简单的工具和尽量快捷的步骤来完成这个分析过程，我们在一台<em>CentOS</em>的服务器上完成这个抓包分析的过程</p><p>首先，我们使用<code class="language-plaintext highlighter-rouge">tcpdump</code>命令，这是一个可以帮助我们对网络数据包进行抓取分析的命令</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tcpdump -nn -X -S -i eth0 port 80
</pre></table></code></div></div><p>命令中用到的参数：<code class="language-plaintext highlighter-rouge">-nn</code>：在展示结果中显示目标IP地址和端口号，<code class="language-plaintext highlighter-rouge">-X</code>：tcpdump 会打印每个包的头部数据, 同时会以16进制和ASCII码形式打印出每个包的数据，<code class="language-plaintext highlighter-rouge">-S</code>：在抓包的内容中会显示绝对序列号而不是相对序列号，<code class="language-plaintext highlighter-rouge">-i</code>：指定要监视的网卡，默认只会监听第一个网卡，<code class="language-plaintext highlighter-rouge">port</code>：指定抓取源或者目的端口是80的包</p><p>使用这条命令后，会进入到抓取监视界面，此时我们打开一个新的窗口，使用<code class="language-plaintext highlighter-rouge">curl</code>命令，这个命令帮助我们对<em>www.douban.com</em>发出一次<code class="language-plaintext highlighter-rouge">GET</code>请求</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl www.douban.com
</pre></table></code></div></div><p>此时，查看<code class="language-plaintext highlighter-rouge">tcpdump</code>抓包结果(这边直接贴上来应该会看得眼花，如果看不清，建议粘贴到<em>VSCode</em>等可以全屏显示的地方，或者自己操作一遍，也能体会得更深刻)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre><td class="rouge-code"><pre>01:40:16.950097 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [S], seq 470463866, win 29200, options [mss 1460,sackOK,TS val 120066337 ecr 0,nop,wscale 7], length 0
        0x0000:  4500 003c a45b 4000 4006 b7e0 c0a8 0024  E..&lt;.[@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b57a 0000 0000  .......P...z....
        0x0020:  a002 7210 deae 0000 0204 05b4 0402 080a  ..r.............
        0x0030:  0728 1121 0000 0000 0103 0307            .(.!........
01:40:16.979743 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [S.], seq 1101183244, ack 470463867, win 43440, options [mss 1440,sackOK,TS val 599874893 ecr 120066337,nop,wscale 9], length 0
        0x0000:  4500 003c 0000 4000 2f06 6d3c 9a08 83ab  E..&lt;..@./.m&lt;....
        0x0010:  c0a8 0024 0050 a3f0 41a2 b90c 1c0a b57b  ...$.P..A......{
        0x0020:  a012 a9b0 b604 0000 0204 05a0 0402 080a  ................
        0x0030:  23c1 5d4d 0728 1121 0103 0309            #.]M.(.!....
01:40:16.979758 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [.], ack 1101183245, win 229, options [nop,nop,TS val 120066367 ecr 599874893], length 0
        0x0000:  4500 0034 a45c 4000 4006 b7e7 c0a8 0024  E..4.\@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b57b 41a2 b90d  .......P...{A...
        0x0020:  8010 00e5 dea6 0000 0101 080a 0728 113f  .............(.?
        0x0030:  23c1 5d4d                                #.]M
01:40:16.979812 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [P.], seq 470463867:470463945, ack 1101183245, win 229, options [nop,nop,TS val 120066367 ecr 599874893], length 78: HTTP: GET / HTTP/1.1
        0x0000:  4500 0082 a45d 4000 4006 b798 c0a8 0024  E....]@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b57b 41a2 b90d  .......P...{A...
        0x0020:  8018 00e5 def4 0000 0101 080a 0728 113f  .............(.?
        0x0030:  23c1 5d4d 4745 5420 2f20 4854 5450 2f31  #.]MGET./.HTTP/1
        0x0040:  2e31 0d0a 5573 6572 2d41 6765 6e74 3a20  .1..User-Agent:.
        0x0050:  6375 726c 2f37 2e32 392e 300d 0a48 6f73  curl/7.29.0..Hos
        0x0060:  743a 2077 7777 2e64 6f75 6261 6e2e 636f  t:.www.douban.co
        0x0070:  6d0d 0a41 6363 6570 743a 202a 2f2a 0d0a  m..Accept:.*/*..
        0x0080:  0d0a                                     ..
01:40:17.009390 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [.], ack 470463945, win 85, options [nop,nop,TS val 599874923 ecr 120066367], length 0
        0x0000:  4500 0034 e586 4000 2f06 87bd 9a08 83ab  E..4..@./.......
        0x0010:  c0a8 0024 0050 a3f0 41a2 b90d 1c0a b5c9  ...$.P..A.......
        0x0020:  8010 0055 8d90 0000 0101 080a 23c1 5d6b  ...U........#.]k
        0x0030:  0728 113f                                .(.?
01:40:17.009393 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [P.], seq 1101183245:1101183620, ack 470463945, win 85, options [nop,nop,TS val 599874923 ecr 120066367], length 375: HTTP: HTTP/1.1 301 Moved Permanently
        0x0000:  4500 01ab e587 4000 2f06 8645 9a08 83ab  E.....@./..E....
        0x0010:  c0a8 0024 0050 a3f0 41a2 b90d 1c0a b5c9  ...$.P..A.......
        0x0020:  8018 0055 4fb5 0000 0101 080a 23c1 5d6b  ...UO.......#.]k
        0x0030:  0728 113f 4854 5450 2f31 2e31 2033 3031  .(.?HTTP/1.1.301
        0x0040:  204d 6f76 6564 2050 6572 6d61 6e65 6e74  .Moved.Permanent
        0x0050:  6c79 0d0a 4461 7465 3a20 5375 6e2c 2030  ly..Date:.Sun,.0
        0x0060:  3220 4175 6720 3230 3230 2031 373a 3430  2.Aug.2020.17:40
        0x0070:  3a31 3620 474d 540d 0a43 6f6e 7465 6e74  :16.GMT..Content
        0x0080:  2d54 7970 653a 2074 6578 742f 6874 6d6c  -Type:.text/html
        0x0090:  0d0a 436f 6e74 656e 742d 4c65 6e67 7468  ..Content-Length
        0x00a0:  3a20 3136 320d 0a43 6f6e 6e65 6374 696f  :.162..Connectio
        0x00b0:  6e3a 206b 6565 702d 616c 6976 650d 0a4b  n:.keep-alive..K
        0x00c0:  6565 702d 416c 6976 653a 2074 696d 656f  eep-Alive:.timeo
        0x00d0:  7574 3d33 300d 0a4c 6f63 6174 696f 6e3a  ut=30..Location:
        0x00e0:  2068 7474 7073 3a2f 2f77 7777 2e64 6f75  .https://www.dou
        0x00f0:  6261 6e2e 636f 6d2f 0d0a 5365 7276 6572  ban.com/..Server
        0x0100:  3a20 6461 650d 0a0d 0a3c 6874 6d6c 3e0d  :.dae....&lt;html&gt;.
        0x0110:  0a3c 6865 6164 3e3c 7469 746c 653e 3330  .&lt;head&gt;&lt;title&gt;30
        0x0120:  3120 4d6f 7665 6420 5065 726d 616e 656e  1.Moved.Permanen
        0x0130:  746c 793c 2f74 6974 6c65 3e3c 2f68 6561  tly&lt;/title&gt;&lt;/hea
        0x0140:  643e 0d0a 3c62 6f64 793e 0d0a 3c63 656e  d&gt;..&lt;body&gt;..&lt;cen
        0x0150:  7465 723e 3c68 313e 3330 3120 4d6f 7665  ter&gt;&lt;h1&gt;301.Move
        0x0160:  6420 5065 726d 616e 656e 746c 793c 2f68  d.Permanently&lt;/h
        0x0170:  313e 3c2f 6365 6e74 6572 3e0d 0a3c 6872  1&gt;&lt;/center&gt;..&lt;hr
        0x0180:  3e3c 6365 6e74 6572 3e6e 6769 6e78 3c2f  &gt;&lt;center&gt;nginx&lt;/
        0x0190:  6365 6e74 6572 3e0d 0a3c 2f62 6f64 793e  center&gt;..&lt;/body&gt;
        0x01a0:  0d0a 3c2f 6874 6d6c 3e0d 0a              ..&lt;/html&gt;..
01:40:17.009406 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [.], ack 1101183620, win 237, options [nop,nop,TS val 120066396 ecr 599874923], length 0
        0x0000:  4500 0034 a45e 4000 4006 b7e5 c0a8 0024  E..4.^@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b5c9 41a2 ba84  .......P....A...
        0x0020:  8010 00ed dea6 0000 0101 080a 0728 115c  .............(.\
        0x0030:  23c1 5d6b                                #.]k
01:40:17.009480 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [F.], seq 470463945, ack 1101183620, win 237, options [nop,nop,TS val 120066396 ecr 599874923], length 0
        0x0000:  4500 0034 a45f 4000 4006 b7e4 c0a8 0024  E..4._@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b5c9 41a2 ba84  .......P....A...
        0x0020:  8011 00ed dea6 0000 0101 080a 0728 115c  .............(.\
        0x0030:  23c1 5d6b                                #.]k
01:40:17.039006 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [F.], seq 1101183620, ack 470463946, win 85, options [nop,nop,TS val 599874953 ecr 120066396], length 0
        0x0000:  4500 0034 e588 4000 2f06 87bb 9a08 83ab  E..4..@./.......
        0x0010:  c0a8 0024 0050 a3f0 41a2 ba84 1c0a b5ca  ...$.P..A.......
        0x0020:  8011 0055 8bdc 0000 0101 080a 23c1 5d89  ...U........#.].
        0x0030:  0728 115c                                .(.\
01:40:17.039013 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [.], ack 1101183621, win 237, options [nop,nop,TS val 120066426 ecr 599874953], length 0
        0x0000:  4500 0034 a460 4000 4006 b7e3 c0a8 0024  E..4.`@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b5ca 41a2 ba85  .......P....A...
        0x0020:  8010 00ed dea6 0000 0101 080a 0728 117a  .............(.z
        0x0030:  23c1 5d89                                #.].
</pre></table></code></div></div><p>来，让我们先冷静一下，我们可以看到，这些消息是分段的，每一个片段以时间，IP开头，每一段就是我们刚刚介绍的TCP报文，从上往下看，我们先看这一部分</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>01:40:16.950097 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [S], seq 470463866, win 29200, options [mss 1460,sackOK,TS val 120066337 ecr 0,nop,wscale 7], length 0
        0x0000:  4500 003c a45b 4000 4006 b7e0 c0a8 0024  E..&lt;.[@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b57a 0000 0000  .......P...z....
        0x0020:  a002 7210 deae 0000 0204 05b4 0402 080a  ..r.............
        0x0030:  0728 1121 0000 0000 0103 0307            .(.!........
01:40:16.979743 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [S.], seq 1101183244, ack 470463867, win 43440, options [mss 1440,sackOK,TS val 599874893 ecr 120066337,nop,wscale 9], length 0
        0x0000:  4500 003c 0000 4000 2f06 6d3c 9a08 83ab  E..&lt;..@./.m&lt;....
        0x0010:  c0a8 0024 0050 a3f0 41a2 b90c 1c0a b57b  ...$.P..A......{
        0x0020:  a012 a9b0 b604 0000 0204 05a0 0402 080a  ................
        0x0030:  23c1 5d4d 0728 1121 0103 0309            #.]M.(.!....
01:40:16.979758 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [.], ack 1101183245, win 229, options [nop,nop,TS val 120066367 ecr 599874893], length 0
        0x0000:  4500 0034 a45c 4000 4006 b7e7 c0a8 0024  E..4.\@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b57b 41a2 b90d  .......P...{A...
        0x0020:  8010 00e5 dea6 0000 0101 080a 0728 113f  .............(.?
        0x0030:  23c1 5d4d                                #.]M
</pre></table></code></div></div><p>首先，每一段的开头的形如<code class="language-plaintext highlighter-rouge">IP 192.168.0.36.41968 &gt; 154.8.131.171.80</code>这样格式的内容，包含了我们之前在报文中提到的源端口和目标端口，这里还显示了IP地址，不过我们需要知道的是，真实的TCP报文中是不会携带IP地址的，这是属于网络层的IP数据报包含的内容。这里这段话告诉我们，这个TCP报文，是从IP地址<em>192.168.0.36</em>的<em>41968</em>端口发往<em>154.8.131.171</em>的<em>80</em>端口，即从我们的客户端发往豆瓣</p><p>上面贴出来的内容分三段，我们主要解析从<code class="language-plaintext highlighter-rouge">Flags</code>开始的内容：</p><ol><li><p>首先<code class="language-plaintext highlighter-rouge">Flags</code>中的中括号代表每次传输时的标志位，这里是标志位是<code class="language-plaintext highlighter-rouge">SYN</code><sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>，即<code class="language-plaintext highlighter-rouge">SYN = 1，ACK = 0</code><sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>，代表发起了一次新建连接的请求，<code class="language-plaintext highlighter-rouge">seq</code>是序列号，在首次传输时，这里初始化了一个随机序列号<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup><em>470463866</em>，也就是我们之前提到的<code class="language-plaintext highlighter-rouge">ISN</code></p><li><p>接着，豆瓣向我们返回了一个报文，标志位是<code class="language-plaintext highlighter-rouge">SYN + ACK</code>，<code class="language-plaintext highlighter-rouge">SYN</code>表示豆瓣也和我们建立起一个连接，<code class="language-plaintext highlighter-rouge">ACK</code>表示我们之前的报文已经确认送达了，这里的<code class="language-plaintext highlighter-rouge">seq</code>是豆瓣那边初始化的随机序列号<em>1101183244</em>，并且报文中<code class="language-plaintext highlighter-rouge">ack</code>，即确认号，为之前我们携带的那个序列号 + 1，即<em>470463866 + 1 = 470463867</em><sup id="fnref:5" role="doc-noteref"><a href="#fn:5" class="footnote" rel="footnote">5</a></sup></p><li><p>最后，我们这边向豆瓣回复了一个报文，标志位为<code class="language-plaintext highlighter-rouge">ACK</code>，确认号为<em>1101183244 + 1 = 1101183245</em>，确认收到了来自豆瓣的连接请求，连接建立</p></ol><p>以上的过程，就是我们经常说的，<strong>TCP的三次握手</strong>，用一张图来表示</p><p><a href="/assets/img/socket-2.svg" class="popup img-link shimmer"><img src="/assets/img/socket-2.svg" alt="" loading="lazy"></a></p><p>再来看中间的内容：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre>01:40:16.979812 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [P.], seq 470463867:470463945, ack 1101183245, win 229, options [nop,nop,TS val 120066367 ecr 599874893], length 78: HTTP: GET / HTTP/1.1
        0x0000:  4500 0082 a45d 4000 4006 b798 c0a8 0024  E....]@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b57b 41a2 b90d  .......P...{A...
        0x0020:  8018 00e5 def4 0000 0101 080a 0728 113f  .............(.?
        0x0030:  23c1 5d4d 4745 5420 2f20 4854 5450 2f31  #.]MGET./.HTTP/1
        0x0040:  2e31 0d0a 5573 6572 2d41 6765 6e74 3a20  .1..User-Agent:.
        0x0050:  6375 726c 2f37 2e32 392e 300d 0a48 6f73  curl/7.29.0..Hos
        0x0060:  743a 2077 7777 2e64 6f75 6261 6e2e 636f  t:.www.douban.co
        0x0070:  6d0d 0a41 6363 6570 743a 202a 2f2a 0d0a  m..Accept:.*/*..
        0x0080:  0d0a                                     ..
01:40:17.009390 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [.], ack 470463945, win 85, options [nop,nop,TS val 599874923 ecr 120066367], length 0
        0x0000:  4500 0034 e586 4000 2f06 87bd 9a08 83ab  E..4..@./.......
        0x0010:  c0a8 0024 0050 a3f0 41a2 b90d 1c0a b5c9  ...$.P..A.......
        0x0020:  8010 0055 8d90 0000 0101 080a 23c1 5d6b  ...U........#.]k
        0x0030:  0728 113f                                .(.?
01:40:17.009393 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [P.], seq 1101183245:1101183620, ack 470463945, win 85, options [nop,nop,TS val 599874923 ecr 120066367], length 375: HTTP: HTTP/1.1 301 Moved Permanently
        0x0000:  4500 01ab e587 4000 2f06 8645 9a08 83ab  E.....@./..E....
        0x0010:  c0a8 0024 0050 a3f0 41a2 b90d 1c0a b5c9  ...$.P..A.......
        0x0020:  8018 0055 4fb5 0000 0101 080a 23c1 5d6b  ...UO.......#.]k
        0x0030:  0728 113f 4854 5450 2f31 2e31 2033 3031  .(.?HTTP/1.1.301
        0x0040:  204d 6f76 6564 2050 6572 6d61 6e65 6e74  .Moved.Permanent
        0x0050:  6c79 0d0a 4461 7465 3a20 5375 6e2c 2030  ly..Date:.Sun,.0
        0x0060:  3220 4175 6720 3230 3230 2031 373a 3430  2.Aug.2020.17:40
        0x0070:  3a31 3620 474d 540d 0a43 6f6e 7465 6e74  :16.GMT..Content
        0x0080:  2d54 7970 653a 2074 6578 742f 6874 6d6c  -Type:.text/html
        0x0090:  0d0a 436f 6e74 656e 742d 4c65 6e67 7468  ..Content-Length
        0x00a0:  3a20 3136 320d 0a43 6f6e 6e65 6374 696f  :.162..Connectio
        0x00b0:  6e3a 206b 6565 702d 616c 6976 650d 0a4b  n:.keep-alive..K
        0x00c0:  6565 702d 416c 6976 653a 2074 696d 656f  eep-Alive:.timeo
        0x00d0:  7574 3d33 300d 0a4c 6f63 6174 696f 6e3a  ut=30..Location:
        0x00e0:  2068 7474 7073 3a2f 2f77 7777 2e64 6f75  .https://www.dou
        0x00f0:  6261 6e2e 636f 6d2f 0d0a 5365 7276 6572  ban.com/..Server
        0x0100:  3a20 6461 650d 0a0d 0a3c 6874 6d6c 3e0d  :.dae....&lt;html&gt;.
        0x0110:  0a3c 6865 6164 3e3c 7469 746c 653e 3330  .&lt;head&gt;&lt;title&gt;30
        0x0120:  3120 4d6f 7665 6420 5065 726d 616e 656e  1.Moved.Permanen
        0x0130:  746c 793c 2f74 6974 6c65 3e3c 2f68 6561  tly&lt;/title&gt;&lt;/hea
        0x0140:  643e 0d0a 3c62 6f64 793e 0d0a 3c63 656e  d&gt;..&lt;body&gt;..&lt;cen
        0x0150:  7465 723e 3c68 313e 3330 3120 4d6f 7665  ter&gt;&lt;h1&gt;301.Move
        0x0160:  6420 5065 726d 616e 656e 746c 793c 2f68  d.Permanently&lt;/h
        0x0170:  313e 3c2f 6365 6e74 6572 3e0d 0a3c 6872  1&gt;&lt;/center&gt;..&lt;hr
        0x0180:  3e3c 6365 6e74 6572 3e6e 6769 6e78 3c2f  &gt;&lt;center&gt;nginx&lt;/
        0x0190:  6365 6e74 6572 3e0d 0a3c 2f62 6f64 793e  center&gt;..&lt;/body&gt;
        0x01a0:  0d0a 3c2f 6874 6d6c 3e0d 0a              ..&lt;/html&gt;..
01:40:17.009406 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [.], ack 1101183620, win 237, options [nop,nop,TS val 120066396 ecr 599874923], length 0
        0x0000:  4500 0034 a45e 4000 4006 b7e5 c0a8 0024  E..4.^@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b5c9 41a2 ba84  .......P....A...
        0x0020:  8010 00ed dea6 0000 0101 080a 0728 115c  .............(.\
        0x0030:  23c1 5d6b                                #.]k
</pre></table></code></div></div><ol><li>首先，我们向豆瓣发送了一个标志位为<code class="language-plaintext highlighter-rouge">PSH</code>和<code class="language-plaintext highlighter-rouge">ACK</code>的报文，注意看这里包开始有内容和length，我们先看内容，可以看到这里是一个HTTP的<code class="language-plaintext highlighter-rouge">GET</code>请求，length，也就是数据的字节长度是<em>78</em>，<code class="language-plaintext highlighter-rouge">seq</code>的值是<em>470463867:470463945</em>，代表这个报文的数据的首字节的序号是<em>470463867</em>，接收方期望接收到的下一个报文的首字节的序号是<em>470463945</em><sup id="fnref:6" role="doc-noteref"><a href="#fn:6" class="footnote" rel="footnote">6</a></sup>，<code class="language-plaintext highlighter-rouge">ack</code>的值依然是<em>1101183245</em>，表示希望接收到的豆瓣的下一个包的<code class="language-plaintext highlighter-rouge">seq</code>是<em>1101183245</em><li>接着，豆瓣回复了我们一个报文，标志位为<code class="language-plaintext highlighter-rouge">ACK</code>，<code class="language-plaintext highlighter-rouge">ack</code>值是<em>470463945</em>，里面没有任何数据，代表豆瓣接收到了我们的报文，并且希望下一个收到的我们的报文的首字节序列号是<em>470463945</em><li>然后，豆瓣又发送给我们一个标志位为<code class="language-plaintext highlighter-rouge">PSH</code>和<code class="language-plaintext highlighter-rouge">ACK</code>的报文，length是<em>375</em>，<code class="language-plaintext highlighter-rouge">seq</code>是 <em>1101183245:1101183620</em>，<code class="language-plaintext highlighter-rouge">ack</code>是<em>470463945</em>，内容中可以看到，豆瓣响应并返回了我们一个HTTP报文，里面含有HTTP报头和一些HTML内容，通过之前的分析，我们可以用一句话来概括，这个报文的首字节序列号是<em>1101183245</em>，豆瓣希望接收到的下一个包的首字节序列号是<em>470463945</em>，不出意外的话，我们回复给豆瓣的<em>ack</em>值应该是<em>1101183620</em><li>最后，我们回复给豆瓣一个标志位为<code class="language-plaintext highlighter-rouge">ACK</code>的报文，<em>ack</em>的值是<em>1101183620</em>，表示我们收到了豆瓣的报文</ol><p>这个，就是数据发送与接收的过程，我们依然用一个图来表示</p><p><a href="/assets/img/socket-3.svg" class="popup img-link shimmer"><img src="/assets/img/socket-3.svg" alt="" loading="lazy"></a></p><p>看最后的一段：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>01:40:17.009480 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [F.], seq 470463945, ack 1101183620, win 237, options [nop,nop,TS val 120066396 ecr 599874923], length 0
        0x0000:  4500 0034 a45f 4000 4006 b7e4 c0a8 0024  E..4._@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b5c9 41a2 ba84  .......P....A...
        0x0020:  8011 00ed dea6 0000 0101 080a 0728 115c  .............(.\
        0x0030:  23c1 5d6b                                #.]k
01:40:17.039006 IP 154.8.131.171.80 &gt; 192.168.0.36.41968: Flags [F.], seq 1101183620, ack 470463946, win 85, options [nop,nop,TS val 599874953 ecr 120066396], length 0
        0x0000:  4500 0034 e588 4000 2f06 87bb 9a08 83ab  E..4..@./.......
        0x0010:  c0a8 0024 0050 a3f0 41a2 ba84 1c0a b5ca  ...$.P..A.......
        0x0020:  8011 0055 8bdc 0000 0101 080a 23c1 5d89  ...U........#.].
        0x0030:  0728 115c                                .(.\
01:40:17.039013 IP 192.168.0.36.41968 &gt; 154.8.131.171.80: Flags [.], ack 1101183621, win 237, options [nop,nop,TS val 120066426 ecr 599874953], length 0
        0x0000:  4500 0034 a460 4000 4006 b7e3 c0a8 0024  E..4.`@.@......$
        0x0010:  9a08 83ab a3f0 0050 1c0a b5ca 41a2 ba85  .......P....A...
        0x0020:  8010 00ed dea6 0000 0101 080a 0728 117a  .............(.z
        0x0030:  23c1 5d89                                #.].
</pre></table></code></div></div><ol><li>首先，我们往豆瓣发送了一个标志位为<code class="language-plaintext highlighter-rouge">FIN</code>和<code class="language-plaintext highlighter-rouge">ACK</code>的报文，首字节序列号是<em>470463945</em>，确认号是<em>1101183620</em>，代表我们收到了豆瓣前面传送的报文，并且表示数据已经发送完毕，可以释放连接<li>接着，豆瓣也向外面发送了一个标志位为<code class="language-plaintext highlighter-rouge">FIN</code>和<code class="language-plaintext highlighter-rouge">ACK</code>的报文，首字节序列号是<em>1101183620</em>，确认号是<em>470463946</em>(这里为什么+1，在前文建立连接的时候有过注释)，也向我们表示可以释放连接<li>最后，我们这边回复给豆瓣一个标志位为<code class="language-plaintext highlighter-rouge">ACK</code>的报文，确认号是<em>1101183621</em>，至此，连接完全关闭</ol><p><a href="/assets/img/socket-4.svg" class="popup img-link shimmer"><img src="/assets/img/socket-4.svg" alt="" loading="lazy"></a></p><h3 id="一些常见的问题"><span class="me-2">一些常见的问题：</span><a href="#一些常见的问题" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>为什么需要握手，为什么是三次</ol><p>根据<em>RFC793</em>上的描述，之所以需要握手来建立连接，因为TCP需要<code class="language-plaintext highlighter-rouge">seq</code>序列号来做可靠重传或接收，为此需要互相确认对方的<code class="language-plaintext highlighter-rouge">ISN</code>。</p><p>那么为什么是三次呢，如果是两次行不行，客户端发送<code class="language-plaintext highlighter-rouge">SYN</code>告知服务器自己的<code class="language-plaintext highlighter-rouge">ISN</code>，服务器再返回<code class="language-plaintext highlighter-rouge">SYN + ACK</code>，确认客户端的序列号并告知客户端自己的<code class="language-plaintext highlighter-rouge">ISN</code>，很显然，这样没有客户端还没确认服务器的<code class="language-plaintext highlighter-rouge">ISN</code>，双方并没有建立起可靠的连接，如果是四次行不行呢，客户端<code class="language-plaintext highlighter-rouge">SYN</code> - 服务器<code class="language-plaintext highlighter-rouge">ACK</code> - 服务器 <code class="language-plaintext highlighter-rouge">SYN</code> - 客户端<code class="language-plaintext highlighter-rouge">ACK</code>，肯定是可以的，之所以是三次，是因为服务器<code class="language-plaintext highlighter-rouge">ACK</code>+服务器<code class="language-plaintext highlighter-rouge">SYN</code>可以合并成一个步骤，也就是说，最少要三次握手</p><p>2.为什么需要挥手，为什么是四次挥手，为什么这次抓包是三次挥手</p><p>为什么需要挥手呢，所谓挥手，其实也就是断开连接，其实不难理解握手是一个双方建立连接的过程，在这个过程中双方会在彼此的操作系统中开辟一些资源用于传输用(初始化一些结构，缓冲区等)，使得双方可以通过某种连接访问到对方的资源，而挥手，就是释放连接，释放资源的过程。</p><p>那么为什么是四次挥手呢，因为TCP是<strong>全双工(Full Duplex)</strong>的，所谓全双工，就是指可以同时进行信号的双向传输，因此当第一次挥手：客户端第一次发送含有<code class="language-plaintext highlighter-rouge">FIN</code>的报文给服务器时，仅仅代表客户端不会再发报文给服务器了，但服务器仍然可以接收报文；第二次挥手：服务器在收到客户端含有<code class="language-plaintext highlighter-rouge">FIN</code>的报文时，可能还有数据报文需要发送给客户端，为了让客户端不会因为没有及时收到应答继续发送<code class="language-plaintext highlighter-rouge">FIN</code>报文，所以先发送<code class="language-plaintext highlighter-rouge">ACK</code>报文告知客户端已经收到其要断开连接的请求；第三次挥手：服务器处理完所有要处理的报文之后，发送<code class="language-plaintext highlighter-rouge">FIN</code>报文给客户端，并进入<code class="language-plaintext highlighter-rouge">LAST_ACK</code>状态；第四次挥手：客户端发送<code class="language-plaintext highlighter-rouge">ACK</code>报文，服务器释放连接</p><p>那么为什么这次的抓包结果是客户端<code class="language-plaintext highlighter-rouge">FIN + ACK</code> - 服务器<code class="language-plaintext highlighter-rouge">FIN + ACK</code> - 客户端 <code class="language-plaintext highlighter-rouge">ACK</code>这样，三次挥手呢，因为这边服务器在接收到客户端的<code class="language-plaintext highlighter-rouge">FIN</code>报文之后也是直接关闭，没有任何后续操作的，所以这里<code class="language-plaintext highlighter-rouge">FIN</code>和<code class="language-plaintext highlighter-rouge">ACK</code>没有必要进行间隔，直接合并在一起发送了</p><h2 id="socket是什么"><span class="me-2">Socket是什么</span><a href="#socket是什么" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>这部分本来打算单独写一篇，但是因为需要特别理解的，和值写的不多，就合并到这里来了</p></blockquote><h3 id="概念浅析"><span class="me-2">概念浅析</span><a href="#概念浅析" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Socket直译成“孔”或“插座”，作为进程之间的一种通信机制，通常也被称为“套接字”，是用于描述IP地址和端口号的通信链的句柄。</p><p>要满足套接字这个概念，必须给出四个元组，一端的Ip+port 和另一端的ip+port，是在整个互联网中唯一表示的，唯一表示互联网中两个程序之间的通信 ，操作系统可以分配的最大的端口号是65535</p><p>问：当一台服务器已经和另一台服务器建立了65536个(0号端口也能用)连接之后，还能不能和其它服务器建立连接</p><p>答：能，因为连往的IP是不同的，还是能唯一表示不同的通信</p><p>问：如果服务器就一台，另一台物理服务器要对其进行一个压力测试，测试其并发数，要怎么做</p><p>答：使用虚拟IP，不断用不同的IP去与其建立连接</p><p>通俗的讲，人与人之间可以通过打电话来进行通信，程序与程序之间要进行通信，互相收发数据，就需要通过Socket来通信，所以不难理解为什么需要描述IP地址和端口号，把电话区号当作IP地址，后面的部分当作端口号，这样构成的一个完整的 电话号码，才能和确切的某一个人进行通话</p><blockquote><p>在这个过程中，协议可以理解成打电话时双方沟通时用的语言，这篇里简单了解，TCP协议是面向连接的，是流式(STREAM)的，每次传输都需要建立三次握手，确保通信过程不会出现数据丢失</p><p>UDP协议是无连接的，是数据报式(DATAGRAM)的，不安全(丢失，顺序混乱，在接收端要分析重排及要求重发)，但效率高，在传输视频的时候通常使用UDP</p></blockquote><p>其实这里的知识，在了解TCP的时候已经有很多可以体会到了，比如为什么必须有四元组，为什么TCP是面向连接的可靠的传输协议，不过因为是先写了一部分这篇，才去写第一篇关于TCP的知识，所以这一部分还是留下来了，不想太过于深究TCP知识，直接看这里也可以</p><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p>从HTTP/1.1起，默认都开启了Keep-Alive，保持连接特性，简单地说，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。 <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:2" role="doc-endnote"><p>工具中的标志位显示的是简写，不难看出，<code class="language-plaintext highlighter-rouge">S</code>是<code class="language-plaintext highlighter-rouge">SYN</code>，<code class="language-plaintext highlighter-rouge">.</code>是<code class="language-plaintext highlighter-rouge">ACK</code>，<code class="language-plaintext highlighter-rouge">F</code>是<code class="language-plaintext highlighter-rouge">FIN</code> <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:3" role="doc-endnote"><p>有哪个标志位，在数据内容上的表示，就是将哪个标志位置为1，否则的话则为0，也就是不带这个标志位 <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:4" role="doc-endnote"><p>为什么初始序列号需要随机，其实想想不难明白，主要有两个原因，如果初始序列号是硬编码1.假如由于各种原因，有一个包在网络中停留太久，本次连接已经结束了，又建立了一个新的连接，在新的连接建立完之后，这个包才到达目标地址上的端口，此时序列号就很容易和新建立起的序列号撞上，正确的数据包就可能被判定为重复包而被丢弃；2.容易被伪造IP地址的他人，通过使用一样的序列号发包 <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:5" role="doc-endnote"><p>在回复<code class="language-plaintext highlighter-rouge">SYN</code>和<code class="language-plaintext highlighter-rouge">FIN</code>报文的时候，为什么要把确认号设置为收到的报文的<code class="language-plaintext highlighter-rouge">seq + 1</code>作为<code class="language-plaintext highlighter-rouge">ack</code>，而不直接用<code class="language-plaintext highlighter-rouge">seq</code>呢，收到的报文数据长度是0呀，而且直接用<code class="language-plaintext highlighter-rouge">seq</code>也能标识，这边找了许多资料，最终找到了一个比较信服的说法：SYNs and FINs require acknowledgement, thus they increment the stream’s sequence number by one when used.For example, if the connection is closed without sending any more data, then if the FIN did <em>not</em> consume a sequence number the closing end couldn’t tell the difference between an ACK for the FIN, and an ACK for the data that was sent prior to the FIN. 意思是说，<code class="language-plaintext highlighter-rouge">SYN</code>和<code class="language-plaintext highlighter-rouge">FIN</code>之所以会将序列号增加一个，是需要做确认，例：如果确认<code class="language-plaintext highlighter-rouge">FIN</code>之后，<code class="language-plaintext highlighter-rouge">seq</code>没有加1，则无法区分哪些是关闭前发送的数据，哪些是关闭之后发送的数据 <a href="#fnref:5" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:6" role="doc-endnote"><p>注意这里期望接收到的下一个包的首字节的序号这个说法，通过观察这里的首字节号和长度不难看出，最后一个字节的字节号不是后面这个数字，所以这个数字代表的是接收方的<code class="language-plaintext highlighter-rouge">ack</code>值，其实这个值在报文里面是不会携带的，报文中携带的<code class="language-plaintext highlighter-rouge">seq</code>只是数据包第一个字节的序号，这里之所以有是工具为了方便我们查看前后关系 <a href="#fnref:6" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">编程基础</a>, <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/" class="post-tag no-text-decoration" >编程基础</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted me-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E.NET%E5%8E%9F%E7%94%9FSocket%E7%9A%84WEB%20API%E8%BD%AC%E5%8F%91%E5%B7%A5%E5%85%B7(1)%20-%20TCP%E5%8D%8F%E8%AE%AE%20-%20HANABI&url=https%3A%2F%2Flambda.cyou%2F%2Fposts%2Fsocket-1%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E.NET%E5%8E%9F%E7%94%9FSocket%E7%9A%84WEB%20API%E8%BD%AC%E5%8F%91%E5%B7%A5%E5%85%B7(1)%20-%20TCP%E5%8D%8F%E8%AE%AE%20-%20HANABI&u=https%3A%2F%2Flambda.cyou%2F%2Fposts%2Fsocket-1%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E5%9F%BA%E4%BA%8E.NET%E5%8E%9F%E7%94%9FSocket%E7%9A%84WEB%20API%E8%BD%AC%E5%8F%91%E5%B7%A5%E5%85%B7(1)%20-%20TCP%E5%8D%8F%E8%AE%AE%20-%20HANABI&url=https%3A%2F%2Flambda.cyou%2F%2Fposts%2Fsocket-1%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="分享链接" data-title-succeed="链接已复制！" > <i class="fa-fw fas fa-link pe-none"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section><h2 class="panel-heading">热门标签</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/net-core/">.NET Core</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">编程基础</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E6%8A%80%E6%9C%AF%E5%A4%87%E5%BF%98/">技术备忘</a> <a class="post-tag btn btn-outline-primary" href="/tags/css/">CSS</a> <a class="post-tag btn btn-outline-primary" href="/tags/html/">HTML</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">Rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E6%97%A5%E5%B8%B8%E5%B7%A5%E5%85%B7/">日常工具</a> <a class="post-tag btn btn-outline-primary" href="/tags/dbms/">DBMS</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">文章内容</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">相关文章</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/foundation-1/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1593705600" data-df="YYYY/MM/DD" > 2020/07/03 </time><h4 class="pt-0 my-2">地基系列 - 引言</h4><div class="text-muted"><p> 前段时间忙着从准备南宁来深圳的事情，忙着收拾，卖二手物品，千辛万苦的搬家，到之后提着大包小包行李赶车，来到这座向往已久的城市，终于得以在现在这个夜晚静下心来，继续更新博客。之后会专门开一个类目，记录生活中的历程 前言：为什么新增一个“地基系列” 难忘的面试 2020年7月2号，到达深圳的第二天，一次难忘的面试。之前有所准备，经历过，也上网浏览过一些公司面试中的笔试题，机试题。但...</p></div></div></a></article><article class="col"> <a href="/posts/foundation-2/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1594656000" data-df="YYYY/MM/DD" > 2020/07/14 </time><h4 class="pt-0 my-2">数据库系统(1) - 辅助存储管理</h4><div class="text-muted"><p> 整理数据库系统(主要是关系数据库系统1)学习过程中的相关知识点，主要学习书籍：数据库系统实现 辅助存储(辅存)管理 在操作一个数据库系统的时候，其本质其实就是对于辅助存储的管理，要了解辅存的相关内容，我们先要了解一些知识： 存储器层次 典型的计算机系统包括几个不同的可以储存数据的部件，这些部件中，最小容量的设备提供了最快的访问速度，也具有相对最高的每个字节的价格，这里用一张知...</p></div></div></a></article><article class="col"> <a href="/posts/foundation-3/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1595174400" data-df="YYYY/MM/DD" > 2020/07/20 </time><h4 class="pt-0 my-2">数据库范式学习笔记</h4><div class="text-muted"><p> 了解数据库范式，作为关系数据库表设计的理论基础之一，主要学习了知乎上的文章——数据库第一二三范式到底在说什么？，这篇只是重新整理归纳，同时作为个人梳理思路，大部分内容和示例来自该文章 范式 什么是范式 数据库的范式(normal forms)，在讨论时通常被缩写成NF，指的是关系数据库内部数据联系的合理化程度，文中1总结为一张表的表结构所符合的某种设计标准的级别，级别从低到高分...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/rust-1/" class="btn btn-outline-primary" aria-label="上一篇" ><p>Rust学习笔记(1) - 常见编程概念</p></a> <a href="/posts/rust-2/" class="btn btn-outline-primary" aria-label="下一篇" ><p>Rust学习笔记(2) - 认识所有权</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> © <time>2024</time> <a href="https://github.com/KamenRiderKuuga">HANABI</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。" >保留部分权利。</span></p><p>本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">热门标签</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/net-core/">.NET Core</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">编程基础</a> <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E6%8A%80%E6%9C%AF%E5%A4%87%E5%BF%98/">技术备忘</a> <a class="post-tag btn btn-outline-primary" href="/tags/css/">CSS</a> <a class="post-tag btn btn-outline-primary" href="/tags/html/">HTML</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">Rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/%E6%97%A5%E5%B8%B8%E5%B7%A5%E5%85%B7/">日常工具</a> <a class="post-tag btn btn-outline-primary" href="/tags/dbms/">DBMS</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">Docker</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/zh.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/unregister.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
